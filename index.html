<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Finance | Dashboard Inteligente</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
        }

        :root {
            --primary: #0066FF;
            --primary-dark: #0052CC;
            --primary-light: #3391FF;
            --secondary: #FF6B35;
            --accent: #00D4AA;
            --danger: #FF4757;
            --warning: #FFA502;
            --success: #00D4AA;
            --economy: #9B59B6;
            --dark: #1A1D29;
            --darker: #151822;
            --light: #F8FAFC;
            --gray: #64748B;
            --gray-dark: #334155;
            --card-bg: rgba(255, 255, 255, 0.05);
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body {
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 50%, #2D1B69 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Tela de Login */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
        }

        .login-logo i {
            font-size: 2.2rem;
        }

        .login-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 25px;
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--gray);
        }

        .login-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .login-form {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .login-form.active {
            display: block;
        }

        /* Header Moderno */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo i {
            font-size: 2rem;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--success));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }

        .user-details {
            text-align: right;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-email {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .logout-btn {
            background: transparent;
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }

        .logout-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* Navega√ß√£o Principal */
        .main-tabs {
            display: flex;
            background: var(--card-bg);
            border-radius: 20px;
            padding: 8px;
            margin-bottom: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }

        .main-tab {
            flex: 1;
            padding: 15px 25px;
            text-align: center;
            cursor: pointer;
            border-radius: 15px;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--gray);
            position: relative;
            overflow: hidden;
        }

        .main-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 8px 25px rgba(0, 102, 255, 0.3);
        }

        .main-tab i {
            margin-right: 8px;
        }

        /* Navega√ß√£o por M√™s */
        .month-navigation {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }

        .month-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 5px 0;
        }

        .month-tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            border: 1px solid transparent;
        }

        .month-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-color: var(--primary-light);
        }

        .month-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        /* Conte√∫do das Abas */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Grid Principal - 4 CAIXAS */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        /* Cards Principais */
        .main-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            height: fit-content;
        }

        .main-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .main-card.revenue {
            border-left: 4px solid var(--success);
        }

        .main-card.essential {
            border-left: 4px solid var(--primary);
        }

        .main-card.non-essential {
            border-left: 4px solid var(--secondary);
        }

        .main-card.economy {
            border-left: 4px solid var(--economy);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--glass-border);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .card-amount {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .card-amount .currency {
            font-size: 1.4rem;
            color: var(--gray);
        }

        .card-amount .value {
            font-size: 2.2rem;
        }

        .card-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }

        .card-progress-bar {
            height: 100%;
            border-radius: 4px;
        }

        .revenue .card-progress-bar { background: var(--success); }
        .essential .card-progress-bar { background: var(--primary); }
        .non-essential .card-progress-bar { background: var(--secondary); }
        .economy .card-progress-bar { background: var(--economy); }

        .card-meta {
            text-align: center;
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 20px;
        }

        /* Formul√°rios dentro dos cards */
        .card-form {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }

        .form-label {
            font-size: 0.8rem;
            color: var(--gray);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 10px 12px;
            color: var(--light);
            font-size: 0.9rem;
            transition: all 0.3s ease;
            width: 100%;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 102, 255, 0.2);
        }

        .form-input::placeholder {
            color: var(--gray);
        }

        .form-row {
            display: grid;
            grid-template-columns: 2fr 1fr auto;
            gap: 8px;
            align-items: end;
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            justify-content: center;
            min-width: 60px;
            font-size: 0.9rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #00b894);
        }

        .btn-economy {
            background: linear-gradient(135deg, var(--economy), #8E44AD);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: var(--glass);
        }

        .btn-sm {
            padding: 6px 10px;
            font-size: 0.8rem;
            min-width: 40px;
        }

        /* Lista de Itens */
        .items-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background-color 0.2s ease;
        }

        .item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px 8px;
        }

        .item:last-child {
            border-bottom: none;
        }

        .item-name {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .item-icon {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }

        .item-amount {
            font-weight: 600;
            margin-right: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .item-actions {
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .item:hover .item-actions {
            opacity: 1;
        }

        .empty-state {
            text-align: center;
            color: var(--gray);
            padding: 30px 20px;
            font-size: 0.9rem;
        }

        /* Modal de Edi√ß√£o */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            width: 90%;
            max-width: 500px;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }

        .modal-close:hover {
            color: var(--light);
        }

        /* Gr√°ficos */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 25px;
        }

        .chart-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* Metas Financeiras */
        .goals-container {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            margin-bottom: 25px;
        }

        /* Cards de Conquistas */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .achievement-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            text-align: center;
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary);
        }

        .achievement-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 102, 255, 0.2);
        }

        .achievement-card.success {
            border-left-color: var(--success);
        }

        .achievement-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--success));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
        }

        .achievement-card.success .achievement-icon {
            background: linear-gradient(135deg, var(--success), #00b894);
        }

        .achievement-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(135deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .achievement-card.success .achievement-value {
            background: linear-gradient(135deg, var(--success), #00b894);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .achievement-label {
            font-size: 0.9rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .achievement-description {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 8px;
        }

        .goals-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .goal-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            position: relative;
            border-left: 4px solid var(--primary);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .goal-title {
            font-weight: 600;
            font-size: 1.3rem;
            color: var(--light);
        }

        .goal-amount {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--success);
            text-align: right;
        }

        .goal-progress-container {
            margin: 20px 0;
        }

        .goal-progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .goal-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .goal-progress-bar {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--success));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .goal-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .goal-detail-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .goal-detail-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .goal-detail-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--light);
        }

        .goal-detail-value.remaining {
            color: var(--primary);
        }

        .goal-detail-value.monthly {
            color: var(--success);
        }

        .goal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* Insights com IA */
        .ai-insight {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            margin-bottom: 20px;
            position: relative;
        }

        .ai-insight::before {
            content: 'ü§ñ';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            opacity: 0.3;
        }

        .insight-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .insight-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--success));
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Notifica√ß√µes */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
        }

        .notification {
            background: var(--card-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 10px;
            backdrop-filter: blur(20px);
            animation: slideInRight 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--danger);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        .notification.info {
            border-left: 4px solid var(--primary);
        }

        .notification-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: white;
        }

        .notification.success .notification-icon {
            background: var(--success);
        }

        .notification.error .notification-icon {
            background: var(--danger);
        }

        .notification.warning .notification-icon {
            background: var(--warning);
        }

        .notification.info .notification-icon {
            background: var(--primary);
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            padding: 5px;
            margin-left: auto;
        }

        .notification-close:hover {
            color: var(--light);
        }

        /* Anima√ß√µes Adicionais */
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* NOVO: Bot√£o de adicionar economia r√°pida - MELHORADO */
        .quick-add-economy {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .quick-add-btn {
            background: rgba(0, 212, 170, 0.15);
            border: 1px solid var(--success);
            color: var(--success);
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .quick-add-btn:hover {
            background: var(--success);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
        }

        .custom-amount-input {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            align-items: stretch;
        }

        .custom-amount-input input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 10px 12px;
            color: var(--light);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .custom-amount-input input:focus {
            outline: none;
            border-color: var(--success);
            box-shadow: 0 0 0 2px rgba(0, 212, 170, 0.2);
        }

        .custom-amount-input button {
            background: var(--success);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            min-width: 120px;
            justify-content: center;
        }

        .custom-amount-input button:hover {
            background: #00b894;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .main-tabs, .month-tabs {
                flex-direction: column;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .achievements-grid {
                grid-template-columns: 1fr;
            }
            
            .goal-details {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .user-menu {
                flex-direction: column;
                gap: 10px;
            }

            .user-info {
                flex-direction: column;
                text-align: center;
            }

            .user-details {
                text-align: center;
            }

            .item-actions {
                opacity: 1;
            }

            .quick-add-economy {
                grid-template-columns: 1fr;
            }

            .custom-amount-input {
                flex-direction: column;
            }

            .custom-amount-input button {
                min-width: auto;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .main-card {
                padding: 20px;
            }
            
            .card-amount {
                font-size: 2rem;
            }
            
            .notification {
                min-width: 280px;
                right: 10px;
            }

            .quick-add-economy {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="login-logo">
                <i class="fas fa-brain-circuit"></i>
                <span>NexusFinance</span>
            </div>
            
            <div class="login-tabs">
                <div class="login-tab active" onclick="switchLoginTab('login')">Entrar</div>
                <div class="login-tab" onclick="switchLoginTab('register')">Cadastrar</div>
            </div>

            <!-- Formul√°rio de Login -->
            <div id="loginForm" class="login-form active">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" placeholder="seu@email.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Sua senha">
                </div>
                <button class="btn" onclick="login()" style="width: 100%; margin-top: 20px;">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                </button>
            </div>

            <!-- Formul√°rio de Cadastro -->
            <div id="registerForm" class="login-form">
                <div class="form-group">
                    <label class="form-label">Nome Completo</label>
                    <input type="text" class="form-input" id="registerName" placeholder="Seu nome completo">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="registerEmail" placeholder="seu@email.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="registerPassword" placeholder="M√≠nimo 6 caracteres">
                </div>
                <div class="form-group">
                    <label class="form-label">Confirmar Senha</label>
                    <input type="password" class="form-input" id="registerConfirmPassword" placeholder="Digite novamente">
                </div>
                <button class="btn btn-success" onclick="register()" style="width: 100%; margin-top: 20px;">
                    <i class="fas fa-user-plus"></i> Criar Conta
                </button>
            </div>
        </div>
    </div>

    <!-- Dashboard (ap√≥s login) -->
    <div id="dashboardScreen" class="container" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-brain-circuit"></i>
                <span>NexusFinance</span>
            </div>
            <div class="user-menu">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">
                        <!-- Inicial ser√° preenchida via JS -->
                    </div>
                    <div class="user-details">
                        <div class="user-name" id="userName">Usu√°rio</div>
                        <div class="user-email" id="userEmail">usuario@email.com</div>
                    </div>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>

        <!-- Navega√ß√£o Principal - ATUALIZADO com √≠cone no Dashboard -->
        <div class="main-tabs">
            <div class="main-tab active" onclick="switchMainTab('dashboard')">
                <i class="fas fa-chart-pie"></i> Dashboard
            </div>
            <div class="main-tab" onclick="switchMainTab('reports')">
                <i class="fas fa-chart-bar"></i> Relat√≥rios
            </div>
            <div class="main-tab" onclick="switchMainTab('goals')">
                <i class="fas fa-bullseye"></i> Metas
            </div>
            <div class="main-tab" onclick="switchMainTab('insights')">
                <i class="fas fa-robot"></i> Insights IA
            </div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <!-- Navega√ß√£o por M√™s -->
            <div class="month-navigation">
                <div class="month-header">
                    <h3>Selecione o M√™s</h3>
                    <span id="currentMonthDisplay">Janeiro 2024</span>
                </div>
                <div class="month-tabs" id="monthTabs">
                    <!-- Preenchido via JavaScript -->
                </div>
            </div>

            <!-- 4 CAIXAS PRINCIPAIS -->
            <div class="dashboard-grid">
                <!-- Receita -->
                <div class="main-card revenue">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>RECEITA</span>
                        </div>
                    </div>
                    
                    <div class="card-amount" id="revenueAmount">
                        <span class="currency">R$</span>
                        <span class="value">0,00</span>
                    </div>
                    <div class="card-meta" id="revenueMeta">Total do m√™s</div>
                    
                    <div class="card-progress">
                        <div class="card-progress-bar" id="revenueProgress" style="width: 0%"></div>
                    </div>

                    <!-- Formul√°rio de Receita -->
                    <div class="card-form">
                        <div class="form-group">
                            <label class="form-label">Descri√ß√£o</label>
                            <input type="text" class="form-input" id="revenueName" placeholder="Sal√°rio, Freela...">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Valor (R$)</label>
                                <input type="number" class="form-input" id="revenueValue" placeholder="0,00" step="0.01">
                            </div>
                            <button class="btn btn-success" onclick="addRevenue()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Lista de Receitas -->
                    <div class="items-list" id="revenueList">
                        <!-- Preenchido via JavaScript -->
                    </div>
                </div>

                <!-- Gastos Essenciais -->
                <div class="main-card essential">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-home"></i>
                            <span>GASTOS ESSENCIAIS</span>
                        </div>
                    </div>
                    
                    <div class="card-amount" id="essentialAmount">
                        <span class="currency">R$</span>
                        <span class="value">0,00</span>
                    </div>
                    <div class="card-meta" id="essentialMeta">0% da receita</div>
                    
                    <div class="card-progress">
                        <div class="card-progress-bar" id="essentialProgress" style="width: 0%"></div>
                    </div>

                    <!-- Formul√°rio de Gastos Essenciais -->
                    <div class="card-form">
                        <div class="form-group">
                            <label class="form-label">Descri√ß√£o</label>
                            <input type="text" class="form-input" id="essentialName" placeholder="Aluguel, Mercado...">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Valor (R$)</label>
                                <input type="number" class="form-input" id="essentialValue" placeholder="0,00" step="0.01">
                            </div>
                            <button class="btn" onclick="addEssentialExpense()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Lista de Gastos Essenciais -->
                    <div class="items-list" id="essentialList">
                        <!-- Preenchido via JavaScript -->
                    </div>
                </div>

                <!-- Gastos N√£o Essenciais -->
                <div class="main-card non-essential">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-gamepad"></i>
                            <span>GASTOS N√ÉO ESSENCIAIS</span>
                        </div>
                    </div>
                    
                    <div class="card-amount" id="nonEssentialAmount">
                        <span class="currency">R$</span>
                        <span class="value">0,00</span>
                    </div>
                    <div class="card-meta" id="nonEssentialMeta">0% da receita</div>
                    
                    <div class="card-progress">
                        <div class="card-progress-bar" id="nonEssentialProgress" style="width: 0%"></div>
                    </div>

                    <!-- Formul√°rio de Gastos N√£o Essenciais -->
                    <div class="card-form">
                        <div class="form-group">
                            <label class="form-label">Descri√ß√£o</label>
                            <input type="text" class="form-input" id="nonEssentialName" placeholder="Lazer, Restaurante...">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Valor (R$)</label>
                                <input type="number" class="form-input" id="nonEssentialValue" placeholder="0,00" step="0.01">
                            </div>
                            <button class="btn" onclick="addNonEssentialExpense()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Lista de Gastos N√£o Essenciais -->
                    <div class="items-list" id="nonEssentialList">
                        <!-- Preenchido via JavaScript -->
                    </div>
                </div>

                <!-- Economia -->
                <div class="main-card economy">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-piggy-bank"></i>
                            <span>ECONOMIA</span>
                        </div>
                    </div>
                    
                    <div class="card-amount" id="economyAmount">
                        <span class="currency">R$</span>
                        <span class="value">0,00</span>
                    </div>
                    <div class="card-meta" id="economyMeta">Saldo final</div>
                    
                    <div class="card-progress">
                        <div class="card-progress-bar" id="economyProgress" style="width: 0%"></div>
                    </div>

                    <!-- Informa√ß√µes de Economia -->
                    <div class="card-form">
                        <div class="form-group">
                            <label class="form-label">Status Financeiro</label>
                            <div id="economyStatus" style="text-align: center; padding: 10px; border-radius: 8px; background: rgba(155, 89, 182, 0.2);">
                                <i class="fas fa-info-circle"></i>
                                <span>Adicione receitas e gastos</span>
                            </div>
                        </div>
                    </div>

                    <!-- Resumo Financeiro -->
                    <div class="items-list" id="economySummary">
                        <!-- Preenchido via JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para Edi√ß√£o -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="editModalTitle">Editar Lan√ßamento</h3>
                    <button class="modal-close" onclick="closeEditModal()">&times;</button>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Descri√ß√£o</label>
                        <input type="text" class="form-input" id="editName" placeholder="Descri√ß√£o...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Valor (R$)</label>
                        <input type="number" class="form-input" id="editValue" placeholder="0,00" step="0.01">
                    </div>
                    <div class="form-group" id="editCategoryGroup" style="display: none;">
                        <label class="form-label">Categoria</label>
                        <select class="form-input" id="editCategory">
                            <option value="essential">Essencial</option>
                            <option value="non-essential">N√£o Essencial</option>
                        </select>
                    </div>
                    <button class="btn btn-success" onclick="saveEdit()" style="margin-top: 15px;">
                        <i class="fas fa-save"></i> Salvar Altera√ß√µes
                    </button>
                </div>
            </div>
        </div>

        <!-- Aba de Relat√≥rios -->
        <div id="reports" class="tab-content">
            <div class="month-navigation">
                <div class="month-header">
                    <h3>Relat√≥rios Financeiros</h3>
                    <span>An√°lise Detalhada</span>
                </div>
            </div>

            <div class="charts-container">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Distribui√ß√£o de Gastos</h3>
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <canvas id="expenseChart"></canvas>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Evolu√ß√£o de Renda</h3>
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <canvas id="incomeChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Aba de Metas -->
        <div id="goals" class="tab-content">
            <div class="goals-container">
                <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                    <h2 class="section-title">Metas Financeiras</h2>
                    <button class="btn" onclick="showAddGoalModal()">
                        <i class="fas fa-bullseye"></i> Nova Meta
                    </button>
                </div>

                <!-- Cards de Conquistas -->
                <div class="achievements-grid" id="achievementsGrid">
                    <!-- Preenchido via JavaScript -->
                </div>
                
                <div class="goals-grid" id="goalsList">
                    <!-- Preenchido via JavaScript -->
                </div>
            </div>
        </div>

        <!-- Modal para Adicionar Meta -->
        <div id="addGoalModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Nova Meta Financeira</h3>
                    <button class="modal-close" onclick="closeAddGoalModal()">&times;</button>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Nome da Meta</label>
                        <input type="text" class="form-input" id="goalName" placeholder="Viagem, Reserva de Emerg√™ncia...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Valor da Meta (R$)</label>
                        <input type="number" class="form-input" id="goalTarget" placeholder="0,00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Valor Atual (R$)</label>
                        <input type="number" class="form-input" id="goalCurrent" placeholder="0,00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Prazo (meses)</label>
                        <input type="number" class="form-input" id="goalDeadline" placeholder="12" min="1">
                    </div>
                    <button class="btn btn-success" onclick="addGoal()" style="margin-top: 15px;">
                        <i class="fas fa-plus"></i> Adicionar Meta
                    </button>
                </div>
            </div>
        </div>

        <!-- Aba de Insights IA -->
        <div id="insights" class="tab-content">
            <div class="ai-insight">
                <div class="insight-header">
                    <div class="insight-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <h3>An√°lise Inteligente</h3>
                </div>
                <p id="aiAnalysis">Adicione seus gastos para receber insights personalizados...</p>
            </div>

            <div class="ai-insight">
                <div class="insight-header">
                    <div class="insight-icon">
                        <i class="fas fa-piggy-bank"></i>
                    </div>
                    <h3>Oportunidades de Economia</h3>
                </div>
                <ul id="savingsTips">
                    <li>Comece adicionando seus gastos para ver dicas personalizadas</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Sistema de Usu√°rios
        let users = JSON.parse(localStorage.getItem('nexusFinanceUsers')) || [];
        let currentUser = JSON.parse(localStorage.getItem('nexusFinanceCurrentUser')) || null;

        // Sistema de Dados (por usu√°rio)
        let expenses = [];
        let revenues = [];
        let goals = [];
        let monthlyBudget = 5000;
        let expenseChartInstance = null;
        let incomeChartInstance = null;
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let currentEditItem = null;
        let currentEditType = null;

        // Registrar o plugin de datalabels globalmente
        Chart.register(ChartDataLabels);

        // Inicializa√ß√£o
        function initApp() {
            if (currentUser) {
                loadUserData();
                showDashboard();
            } else {
                showLogin();
            }
        }

        // Sistema de Autentica√ß√£o
        function switchLoginTab(tab) {
            document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.login-form').forEach(f => f.classList.remove('active'));
            
            document.querySelector(`.login-tab[onclick="switchLoginTab('${tab}')"]`).classList.add('active');
            document.getElementById(`${tab}Form`).classList.add('active');
        }

        function register() {
            const name = document.getElementById('registerName').value.trim();
            const email = document.getElementById('registerEmail').value.trim().toLowerCase();
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;

            if (!name || !email || !password) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }

            if (password.length < 6) {
                showNotification('A senha deve ter pelo menos 6 caracteres!', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('As senhas n√£o coincidem!', 'error');
                return;
            }

            if (users.find(user => user.email === email)) {
                showNotification('Este email j√° est√° cadastrado!', 'error');
                return;
            }

            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('nexusFinanceUsers', JSON.stringify(users));
            
            showNotification('Conta criada com sucesso! Fa√ßa login para continuar.', 'success');
            switchLoginTab('login');
            
            // Limpar formul√°rio
            document.getElementById('registerName').value = '';
            document.getElementById('registerEmail').value = '';
            document.getElementById('registerPassword').value = '';
            document.getElementById('registerConfirmPassword').value = '';
        }

        function login() {
            const email = document.getElementById('loginEmail').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;

            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                currentUser = user;
                localStorage.setItem('nexusFinanceCurrentUser', JSON.stringify(currentUser));
                loadUserData();
                showDashboard();
                showNotification(`Bem-vindo de volta, ${user.name}!`, 'success');
            } else {
                showNotification('Email ou senha incorretos!', 'error');
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('nexusFinanceCurrentUser');
            showLogin();
            showNotification('Logout realizado com sucesso!', 'info');
        }

        function showLogin() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('dashboardScreen').style.display = 'none';
        }

        function showDashboard() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('dashboardScreen').style.display = 'block';
            
            // Atualizar informa√ß√µes do usu√°rio
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userEmail').textContent = currentUser.email;
            
            // Criar avatar com iniciais
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('userAvatar').innerHTML = initials.substring(0, 2);
            
            // Inicializar dashboard
            initMonthTabs();
            updateDashboard();
            renderAchievements();
            renderGoals();
            updateInsights();
        }

        function loadUserData() {
            const userData = JSON.parse(localStorage.getItem(`nexusFinanceData_${currentUser.id}`)) || {
                expenses: [],
                revenues: [],
                goals: []
            };
            
            expenses = userData.expenses || [];
            revenues = userData.revenues || [];
            goals = userData.goals || [];
        }

        function saveUserData() {
            const userData = {
                expenses,
                revenues,
                goals
            };
            localStorage.setItem(`nexusFinanceData_${currentUser.id}`, JSON.stringify(userData));
        }

        // Sistema de Meses
        function initMonthTabs() {
            const monthTabs = document.getElementById('monthTabs');
            const months = [
                'Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];

            monthTabs.innerHTML = months.map((month, index) => `
                <div class="month-tab ${index === currentMonth ? 'active' : ''}" 
                     onclick="switchMonth(${index})">
                    ${month}
                </div>
            `).join('');

            updateMonthDisplay();
        }

        function switchMonth(monthIndex) {
            currentMonth = monthIndex;
            document.querySelectorAll('.month-tab').forEach((tab, index) => {
                tab.classList.toggle('active', index === monthIndex);
            });
            updateMonthDisplay();
            updateDashboard();
        }

        function updateMonthDisplay() {
            const months = [
                'Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            document.getElementById('currentMonthDisplay').textContent = 
                `${months[currentMonth]} ${currentYear}`;
        }

        // Adicionar Receita
        function addRevenue() {
            const name = document.getElementById('revenueName').value.trim();
            const value = parseFloat(document.getElementById('revenueValue').value);

            if (!name || isNaN(value) || value <= 0) {
                showNotification('Preencha todos os campos corretamente!', 'error');
                return;
            }

            const revenue = {
                id: Date.now(),
                name,
                value,
                month: currentMonth,
                year: currentYear,
                date: new Date().toISOString(),
                type: 'receita'
            };

            revenues.push(revenue);
            saveUserData();
            updateDashboard();
            
            // Limpar formul√°rio
            document.getElementById('revenueName').value = '';
            document.getElementById('revenueValue').value = '';

            showNotification('Receita adicionada com sucesso!', 'success');
        }

        // Adicionar Gasto Essencial
        function addEssentialExpense() {
            const name = document.getElementById('essentialName').value.trim();
            const value = parseFloat(document.getElementById('essentialValue').value);

            if (!name || isNaN(value) || value <= 0) {
                showNotification('Preencha todos os campos corretamente!', 'error');
                return;
            }

            const expense = {
                id: Date.now(),
                name,
                value,
                category: 'essential',
                month: currentMonth,
                year: currentYear,
                date: new Date().toISOString(),
                type: 'gasto'
            };

            expenses.push(expense);
            saveUserData();
            updateDashboard();

            // Limpar formul√°rio
            document.getElementById('essentialName').value = '';
            document.getElementById('essentialValue').value = '';

            showNotification('Gasto essencial adicionado com sucesso!', 'success');
        }

        // Adicionar Gasto N√£o Essencial
        function addNonEssentialExpense() {
            const name = document.getElementById('nonEssentialName').value.trim();
            const value = parseFloat(document.getElementById('nonEssentialValue').value);

            if (!name || isNaN(value) || value <= 0) {
                showNotification('Preencha todos os campos corretamente!', 'error');
                return;
            }

            const expense = {
                id: Date.now(),
                name,
                value,
                category: 'non-essential',
                month: currentMonth,
                year: currentYear,
                date: new Date().toISOString(),
                type: 'gasto'
            };

            expenses.push(expense);
            saveUserData();
            updateDashboard();

            // Limpar formul√°rio
            document.getElementById('nonEssentialName').value = '';
            document.getElementById('nonEssentialValue').value = '';

            showNotification('Gasto n√£o essencial adicionado com sucesso!', 'success');
        }

        // Editar Lan√ßamento
        function editItem(id, type) {
            let item;
            if (type === 'revenue') {
                item = revenues.find(rev => rev.id === id);
            } else {
                item = expenses.find(exp => exp.id === id);
            }

            if (!item) return;

            currentEditItem = item;
            currentEditType = type;

            document.getElementById('editName').value = item.name;
            document.getElementById('editValue').value = item.value;

            if (type === 'expense') {
                document.getElementById('editCategoryGroup').style.display = 'block';
                document.getElementById('editCategory').value = item.category;
                document.getElementById('editModalTitle').textContent = 'Editar Gasto';
            } else {
                document.getElementById('editCategoryGroup').style.display = 'none';
                document.getElementById('editModalTitle').textContent = 'Editar Receita';
            }

            document.getElementById('editModal').classList.add('active');
        }

        // Salvar Edi√ß√£o
        function saveEdit() {
            if (!currentEditItem) return;

            const name = document.getElementById('editName').value.trim();
            const value = parseFloat(document.getElementById('editValue').value);

            if (!name || isNaN(value) || value <= 0) {
                showNotification('Preencha todos os campos corretamente!', 'error');
                return;
            }

            currentEditItem.name = name;
            currentEditItem.value = value;

            if (currentEditType === 'expense') {
                currentEditItem.category = document.getElementById('editCategory').value;
            }

            saveUserData();
            updateDashboard();
            closeEditModal();

            showNotification('Lan√ßamento atualizado com sucesso!', 'success');
        }

        // Fechar Modal de Edi√ß√£o
        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
            currentEditItem = null;
            currentEditType = null;
        }

        // Remover Lan√ßamento
        function removeItem(id, type) {
            if (!confirm('Tem certeza que deseja excluir este lan√ßamento?')) {
                return;
            }

            if (type === 'revenue') {
                revenues = revenues.filter(rev => rev.id !== id);
            } else {
                expenses = expenses.filter(exp => exp.id !== id);
            }

            saveUserData();
            updateDashboard();
            showNotification('Lan√ßamento removido com sucesso!', 'warning');
        }

        // Adicionar Meta
        function addGoal() {
            const name = document.getElementById('goalName').value.trim();
            const target = parseFloat(document.getElementById('goalTarget').value);
            const current = parseFloat(document.getElementById('goalCurrent').value);
            const deadline = parseInt(document.getElementById('goalDeadline').value);

            if (!name || isNaN(target) || target <= 0 || isNaN(current) || current < 0 || isNaN(deadline) || deadline <= 0) {
                showNotification('Preencha todos os campos corretamente!', 'error');
                return;
            }

            const goal = {
                id: Date.now(),
                name,
                target,
                current,
                deadline,
                createdAt: new Date().toISOString()
            };

            goals.push(goal);
            saveUserData();
            renderAchievements();
            renderGoals();
            closeAddGoalModal();

            showNotification('Meta adicionada com sucesso!', 'success');
        }

        // NOVA FUN√á√ÉO: Adicionar economia r√°pida √† meta
        function addEconomyToGoal(goalId, amount) {
            const goal = goals.find(g => g.id === goalId);
            if (!goal) return;

            // Arredondar para 2 casas decimais
            amount = Math.round(amount * 100) / 100;
            
            goal.current += amount;
            
            // N√£o permitir que o valor atual ultrapasse o target
            if (goal.current > goal.target) {
                goal.current = goal.target;
            }

            // Garantir apenas 2 casas decimais
            goal.current = Math.round(goal.current * 100) / 100;

            saveUserData();
            renderAchievements();
            renderGoals();
            
            showNotification(`R$ ${amount.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} adicionado √† meta "${goal.name}"!`, 'success');
        }

        // NOVA FUN√á√ÉO: Adicionar valor personalizado √† meta
        function addCustomEconomy(goalId) {
            const input = document.getElementById(`customAmount-${goalId}`);
            const amount = parseFloat(input.value);

            if (isNaN(amount) || amount <= 0) {
                showNotification('Digite um valor v√°lido!', 'error');
                return;
            }

            addEconomyToGoal(goalId, amount);
            input.value = '';
        }

        // Remover Meta
        function removeGoal(id) {
            goals = goals.filter(goal => goal.id !== id);
            saveUserData();
            renderAchievements();
            renderGoals();
            showNotification('Meta removida!', 'warning');
        }

        // Atualizar Dashboard - CORRIGIDO o alinhamento dos valores
        function updateDashboard() {
            const monthExpenses = expenses.filter(exp => 
                exp.month === currentMonth && exp.year === currentYear
            );
            const monthRevenues = revenues.filter(rev => 
                rev.month === currentMonth && rev.year === currentYear
            );

            const essentialTotal = monthExpenses
                .filter(exp => exp.category === 'essential')
                .reduce((sum, exp) => sum + exp.value, 0);

            const nonEssentialTotal = monthExpenses
                .filter(exp => exp.category === 'non-essential')
                .reduce((sum, exp) => sum + exp.value, 0);

            const revenueTotal = monthRevenues
                .reduce((sum, rev) => sum + rev.value, 0);

            const totalExpenses = essentialTotal + nonEssentialTotal;
            const economy = revenueTotal - totalExpenses;

            // Atualizar cards - CORRIGIDO: usando estrutura separada para R$ e valor
            document.getElementById('revenueAmount').innerHTML = 
                `<span class="currency">R$</span><span class="value">${revenueTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>`;
            document.getElementById('essentialAmount').innerHTML = 
                `<span class="currency">R$</span><span class="value">${essentialTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>`;
            document.getElementById('nonEssentialAmount').innerHTML = 
                `<span class="currency">R$</span><span class="value">${nonEssentialTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>`;
            document.getElementById('economyAmount').innerHTML = 
                `<span class="currency">R$</span><span class="value">${economy.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>`;

            // Atualizar progresso
            const essentialPercent = revenueTotal > 0 ? Math.min((essentialTotal / revenueTotal) * 100, 100) : 0;
            const nonEssentialPercent = revenueTotal > 0 ? Math.min((nonEssentialTotal / revenueTotal) * 100, 100) : 0;
            const revenueUsagePercent = revenueTotal > 0 ? Math.min((totalExpenses / revenueTotal) * 100, 100) : 0;
            const economyPercent = revenueTotal > 0 ? Math.max((economy / revenueTotal) * 100, 0) : 0;

            document.getElementById('essentialProgress').style.width = `${essentialPercent}%`;
            document.getElementById('nonEssentialProgress').style.width = `${nonEssentialPercent}%`;
            document.getElementById('revenueProgress').style.width = `${revenueUsagePercent}%`;
            document.getElementById('economyProgress').style.width = `${economyPercent}%`;

            document.getElementById('essentialMeta').textContent = 
                `${essentialPercent.toFixed(1)}% da receita`;
            document.getElementById('nonEssentialMeta').textContent = 
                `${nonEssentialPercent.toFixed(1)}% da receita`;
            document.getElementById('revenueMeta').textContent = 
                `${revenueTotal > 0 ? 'Total do m√™s' : 'Sem receitas'}`;
            document.getElementById('economyMeta').textContent = 
                `${economyPercent.toFixed(1)}% da receita`;

            // Atualizar status da economia
            const economyStatus = document.getElementById('economyStatus');
            if (economy > 0) {
                economyStatus.innerHTML = '<i class="fas fa-check-circle"></i> <span>Saldo positivo!</span>';
                economyStatus.style.background = 'rgba(0, 212, 170, 0.2)';
                economyStatus.style.color = 'var(--success)';
            } else if (economy < 0) {
                economyStatus.innerHTML = '<i class="fas fa-exclamation-triangle"></i> <span>Saldo negativo</span>';
                economyStatus.style.background = 'rgba(255, 71, 87, 0.2)';
                economyStatus.style.color = 'var(--danger)';
            } else {
                economyStatus.innerHTML = '<i class="fas fa-info-circle"></i> <span>Saldo zerado</span>';
                economyStatus.style.background = 'rgba(155, 89, 182, 0.2)';
                economyStatus.style.color = 'var(--economy)';
            }

            // Atualizar listas
            updateRevenueList(monthRevenues);
            updateEssentialList(monthExpenses.filter(exp => exp.category === 'essential'));
            updateNonEssentialList(monthExpenses.filter(exp => exp.category === 'non-essential'));
            updateEconomySummary(revenueTotal, essentialTotal, nonEssentialTotal, economy);
        }

        // Atualizar Listas - CORRIGIDO o alinhamento dos valores nas listas
        function updateRevenueList(revenues) {
            const revenueList = document.getElementById('revenueList');
            if (revenues.length === 0) {
                revenueList.innerHTML = '<div class="empty-state">Nenhuma receita este m√™s</div>';
            } else {
                revenueList.innerHTML = revenues.map(revenue => `
                    <div class="item">
                        <div class="item-name">
                            <div class="item-icon" style="background: rgba(0, 212, 170, 0.2); color: var(--success);">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <span>${revenue.name}</span>
                        </div>
                        <div class="item-amount" style="color: var(--success);">
                            <span class="currency">R$</span>
                            <span class="value">${revenue.value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div class="item-actions">
                            <button class="btn btn-secondary btn-sm" onclick="editItem(${revenue.id}, 'revenue')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="removeItem(${revenue.id}, 'revenue')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateEssentialList(essentialExpenses) {
            const essentialList = document.getElementById('essentialList');
            if (essentialExpenses.length === 0) {
                essentialList.innerHTML = '<div class="empty-state">Nenhum gasto essencial este m√™s</div>';
            } else {
                essentialList.innerHTML = essentialExpenses.map(expense => `
                    <div class="item">
                        <div class="item-name">
                            <div class="item-icon" style="background: rgba(0, 102, 255, 0.2); color: var(--primary);">
                                <i class="fas fa-home"></i>
                            </div>
                            <span>${expense.name}</span>
                        </div>
                        <div class="item-amount">
                            <span class="currency">R$</span>
                            <span class="value">${expense.value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div class="item-actions">
                            <button class="btn btn-secondary btn-sm" onclick="editItem(${expense.id}, 'expense')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="removeItem(${expense.id}, 'expense')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateNonEssentialList(nonEssentialExpenses) {
            const nonEssentialList = document.getElementById('nonEssentialList');
            if (nonEssentialExpenses.length === 0) {
                nonEssentialList.innerHTML = '<div class="empty-state">Nenhum gasto n√£o essencial este m√™s</div>';
            } else {
                nonEssentialList.innerHTML = nonEssentialExpenses.map(expense => `
                    <div class="item">
                        <div class="item-name">
                            <div class="item-icon" style="background: rgba(255, 107, 53, 0.2); color: var(--secondary);">
                                <i class="fas fa-gamepad"></i>
                            </div>
                            <span>${expense.name}</span>
                        </div>
                        <div class="item-amount">
                            <span class="currency">R$</span>
                            <span class="value">${expense.value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div class="item-actions">
                            <button class="btn btn-secondary btn-sm" onclick="editItem(${expense.id}, 'expense')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="removeItem(${expense.id}, 'expense')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateEconomySummary(revenue, essential, nonEssential, economy) {
            const economySummary = document.getElementById('economySummary');
            const economyPercent = revenue > 0 ? ((economy / revenue) * 100).toFixed(1) : 0;
            
            economySummary.innerHTML = `
                <div class="item">
                    <div class="item-name">
                        <div class="item-icon" style="background: rgba(0, 212, 170, 0.2); color: var(--success);">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <span>Receita Total</span>
                    </div>
                    <div class="item-amount" style="color: var(--success);">
                        <span class="currency">R$</span>
                        <span class="value">${revenue.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                </div>
                <div class="item">
                    <div class="item-name">
                        <div class="item-icon" style="background: rgba(0, 102, 255, 0.2); color: var(--primary);">
                            <i class="fas fa-home"></i>
                        </div>
                        <span>Gastos Essenciais</span>
                    </div>
                    <div class="item-amount">
                        <span class="currency">R$</span>
                        <span class="value">${essential.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                </div>
                <div class="item">
                    <div class="item-name">
                        <div class="item-icon" style="background: rgba(255, 107, 53, 0.2); color: var(--secondary);">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <span>Gastos N√£o Essenciais</span>
                    </div>
                    <div class="item-amount">
                        <span class="currency">R$</span>
                        <span class="value">${nonEssential.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                </div>
                <div class="item" style="border-top: 2px solid var(--economy); padding-top: 15px; margin-top: 10px;">
                    <div class="item-name">
                        <div class="item-icon" style="background: rgba(155, 89, 182, 0.2); color: var(--economy);">
                            <i class="fas fa-piggy-bank"></i>
                        </div>
                        <span><strong>Economia Final</strong></span>
                    </div>
                    <div class="item-amount" style="color: var(--economy); font-weight: bold;">
                        <span class="currency">R$</span>
                        <span class="value">${economy.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                </div>
            `;
        }

        // Atualizar Gr√°ficos
        function updateCharts() {
            const monthExpenses = expenses.filter(exp => 
                exp.month === currentMonth && exp.year === currentYear
            );
            const monthRevenues = revenues.filter(rev => 
                rev.month === currentMonth && rev.year === currentYear
            );

            const essentialTotal = monthExpenses
                .filter(exp => exp.category === 'essential')
                .reduce((sum, exp) => sum + exp.value, 0);

            const nonEssentialTotal = monthExpenses
                .filter(exp => exp.category === 'non-essential')
                .reduce((sum, exp) => sum + exp.value, 0);

            const revenueTotal = monthRevenues
                .reduce((sum, rev) => sum + rev.value, 0);

            const savings = Math.max(0, revenueTotal - essentialTotal - nonEssentialTotal);
            const total = essentialTotal + nonEssentialTotal + savings;
            
            // Destruir gr√°ficos existentes
            if (expenseChartInstance) {
                expenseChartInstance.destroy();
            }
            if (incomeChartInstance) {
                incomeChartInstance.destroy();
            }

            // Gr√°fico de Distribui√ß√£o de Gastos
            const expenseCtx = document.getElementById('expenseChart').getContext('2d');
            expenseChartInstance = new Chart(expenseCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Essenciais', 'N√£o Essenciais', 'Economia'],
                    datasets: [{
                        data: [essentialTotal, nonEssentialTotal, savings],
                        backgroundColor: ['#0066FF', '#FF6B35', '#00D4AA'],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#F8FAFC',
                                padding: 20,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : '0';
                                    return `${label}: R$ ${value.toLocaleString('pt-BR', { minimumFractionDigits: 2 })} (${percentage}%)`;
                                }
                            }
                        },
                        datalabels: {
                            color: '#FFFFFF',
                            font: {
                                size: 10,
                                weight: 'bold'
                            },
                            formatter: (value, context) => {
                                if (value > 0) {
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : '0';
                                    return `R$ ${value.toLocaleString('pt-BR', { minimumFractionDigits: 0 })}\n${percentage}%`;
                                }
                                return '';
                            },
                            textShadow: '0px 1px 2px rgba(0, 0, 0, 0.8)',
                            textAlign: 'center'
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Gr√°fico de Evolu√ß√£o de Renda - ATUALIZADO para mostrar todos os meses
            const incomeCtx = document.getElementById('incomeChart').getContext('2d');
            const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            const monthlyRevenues = months.map((month, index) => {
                const monthRevs = revenues.filter(rev => 
                    rev.month === index && rev.year === currentYear
                );
                return monthRevs.reduce((sum, rev) => sum + rev.value, 0);
            });

            incomeChartInstance = new Chart(incomeCtx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Receita Mensal',
                        data: monthlyRevenues,
                        borderColor: '#00D4AA',
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3,
                        pointBackgroundColor: '#00D4AA',
                        pointBorderColor: '#FFFFFF',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#F8FAFC',
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Receita: R$ ${context.raw.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
                                }
                            }
                        },
                        datalabels: {
                            color: '#FFFFFF',
                            font: {
                                size: 10,
                                weight: 'bold'
                            },
                            formatter: (value) => {
                                if (value > 0) {
                                    return `R$ ${value.toLocaleString('pt-BR', { minimumFractionDigits: 0 })}`;
                                }
                                return '';
                            },
                            align: 'top',
                            offset: 8,
                            textShadow: '0px 1px 2px rgba(0, 0, 0, 0.8)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: {
                                color: '#F8FAFC',
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString('pt-BR');
                                }
                            }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#F8FAFC' }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // Sistema de Conquistas
        function renderAchievements() {
            const achievementsGrid = document.getElementById('achievementsGrid');
            
            const totalGoals = goals.length;
            const completedGoals = goals.filter(goal => goal.current >= goal.target).length;
            const inProgressGoals = totalGoals - completedGoals;
            const completionRate = totalGoals > 0 ? (completedGoals / totalGoals * 100).toFixed(0) : 0;

            achievementsGrid.innerHTML = `
                <div class="achievement-card">
                    <div class="achievement-icon">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    <div class="achievement-value">${totalGoals}</div>
                    <div class="achievement-label">Total de Metas</div>
                    <div class="achievement-description">Metas criadas at√© agora</div>
                </div>

                <div class="achievement-card success">
                    <div class="achievement-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="achievement-value">${completedGoals}</div>
                    <div class="achievement-label">Metas Conclu√≠das</div>
                    <div class="achievement-description">Objetivos alcan√ßados</div>
                </div>

                <div class="achievement-card">
                    <div class="achievement-icon">
                        <i class="fas fa-spinner"></i>
                    </div>
                    <div class="achievement-value">${inProgressGoals}</div>
                    <div class="achievement-label">Em Andamento</div>
                    <div class="achievement-description">Metas sendo trabalhadas</div>
                </div>

                <div class="achievement-card success">
                    <div class="achievement-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="achievement-value">${completionRate}%</div>
                    <div class="achievement-label">Taxa de Sucesso</div>
                    <div class="achievement-description">Efici√™ncia nas metas</div>
                </div>
            `;
        }

        // Sistema de Metas - ATUALIZADO com bot√µes de economia r√°pida MELHORADOS
        function renderGoals() {
            const goalsList = document.getElementById('goalsList');
            
            if (goals.length === 0) {
                goalsList.innerHTML = `
                    <div style="text-align: center; padding: 60px; color: var(--gray);">
                        <i class="fas fa-bullseye" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>Nenhuma meta cadastrada</h3>
                        <p>Comece criando suas metas financeiras</p>
                    </div>
                `;
                return;
            }

            goalsList.innerHTML = goals.map(goal => {
                const progress = (goal.current / goal.target) * 100;
                const remaining = goal.target - goal.current;
                const monthlySave = remaining / goal.deadline;
                const isCompleted = goal.current >= goal.target;

                return `
                    <div class="goal-card ${isCompleted ? 'success' : ''}">
                        <div class="goal-header">
                            <div class="goal-title">
                                ${goal.name}
                                ${isCompleted ? '<span style="color: var(--success); margin-left: 10px;"><i class="fas fa-check-circle"></i> Conclu√≠da</span>' : ''}
                            </div>
                            <div class="goal-amount">
                                R$ ${goal.current.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}<br>
                                <small style="font-size: 0.9rem; color: var(--gray);">de R$ ${goal.target.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</small>
                            </div>
                        </div>
                        
                        <div class="goal-progress-container">
                            <div class="goal-progress-info">
                                <span>Progresso</span>
                                <span>${progress.toFixed(1)}%</span>
                            </div>
                            <div class="goal-progress">
                                <div class="goal-progress-bar" style="width: ${Math.min(progress, 100)}%"></div>
                            </div>
                        </div>
                        
                        ${!isCompleted ? `
                        <div class="goal-details">
                            <div class="goal-detail-item">
                                <div class="goal-detail-label">Falta Economizar</div>
                                <div class="goal-detail-value remaining">R$ ${remaining.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            </div>
                            <div class="goal-detail-item">
                                <div class="goal-detail-label">Economia Mensal</div>
                                <div class="goal-detail-value monthly">R$ ${monthlySave.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            </div>
                        </div>

                        <!-- MELHORADO: Bot√µes de economia r√°pida -->
                        <div class="quick-add-economy">
                            <button class="quick-add-btn" onclick="addEconomyToGoal(${goal.id}, 50)">
                                <i class="fas fa-plus"></i> R$ 50
                            </button>
                            <button class="quick-add-btn" onclick="addEconomyToGoal(${goal.id}, 100)">
                                <i class="fas fa-plus"></i> R$ 100
                            </button>
                            <button class="quick-add-btn" onclick="addEconomyToGoal(${goal.id}, 200)">
                                <i class="fas fa-plus"></i> R$ 200
                            </button>
                            <button class="quick-add-btn" onclick="addEconomyToGoal(${goal.id}, 500)">
                                <i class="fas fa-plus"></i> R$ 500
                            </button>
                        </div>

                        <!-- MELHORADO: Input para valor personalizado -->
                        <div class="custom-amount-input">
                            <input type="number" id="customAmount-${goal.id}" placeholder="Digite outro valor..." step="0.01" min="0.01">
                            <button onclick="addCustomEconomy(${goal.id})">
                                <i class="fas fa-plus-circle"></i> Adicionar
                            </button>
                        </div>
                        ` : ''}
                        
                        <div class="goal-actions">
                            <button class="btn-outline" onclick="removeGoal(${goal.id})">
                                <i class="fas fa-trash"></i>
                                Remover Meta
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Modal Functions
        function showAddGoalModal() {
            document.getElementById('addGoalModal').classList.add('active');
            document.getElementById('goalName').value = '';
            document.getElementById('goalTarget').value = '';
            document.getElementById('goalCurrent').value = '';
            document.getElementById('goalDeadline').value = '12';
        }

        function closeAddGoalModal() {
            document.getElementById('addGoalModal').classList.remove('active');
        }

        // Sistema de Abas Principal - ATUALIZADO com √≠cone no Dashboard
        function switchMainTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.main-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'insights') {
                updateInsights();
            } else if (tabName === 'reports') {
                updateCharts();
            }
        }

        // Atualizar Insights da IA
        function updateInsights() {
            const monthExpenses = expenses.filter(exp => 
                exp.month === currentMonth && exp.year === currentYear
            );
            const monthRevenues = revenues.filter(rev => 
                rev.month === currentMonth && rev.year === currentYear
            );

            const essentialTotal = monthExpenses
                .filter(exp => exp.category === 'essential')
                .reduce((sum, exp) => sum + exp.value, 0);

            const nonEssentialTotal = monthExpenses
                .filter(exp => exp.category === 'non-essential')
                .reduce((sum, exp) => sum + exp.value, 0);

            const revenueTotal = monthRevenues
                .reduce((sum, rev) => sum + rev.value, 0);

            const total = essentialTotal + nonEssentialTotal;
            const savings = revenueTotal - total;

            if (total === 0) {
                document.getElementById('aiAnalysis').textContent = 
                    'Adicione seus gastos para receber uma an√°lise inteligente do seu comportamento financeiro.';
                return;
            }

            const essentialPercent = ((essentialTotal / total) * 100).toFixed(1);
            const nonEssentialPercent = ((nonEssentialTotal / total) * 100).toFixed(1);
            const savingsRate = ((savings / revenueTotal) * 100).toFixed(1);

            let analysis = `Voc√™ gasta ${essentialPercent}% em necessidades essenciais e ${nonEssentialPercent}% em gastos vari√°veis. `;
            
            if (savings > 0) {
                analysis += `Sua taxa de economia est√° em ${savingsRate}% (R$ ${savings.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}). `;
            } else {
                analysis += `‚ö†Ô∏è Aten√ß√£o: Voc√™ est√° gastando mais do que ganha este m√™s. `;
            }

            // An√°lise comparativa com o m√™s anterior
            const prevMonth = currentMonth === 0 ? 11 : currentMonth - 1;
            const prevYear = currentMonth === 0 ? currentYear - 1 : currentYear;
            
            const prevMonthExpenses = expenses.filter(exp => 
                exp.month === prevMonth && exp.year === prevYear
            ).reduce((sum, exp) => sum + exp.value, 0);

            if (prevMonthExpenses > 0) {
                const change = ((total - prevMonthExpenses) / prevMonthExpenses * 100).toFixed(1);
                if (Math.abs(change) > 5) {
                    analysis += `Seus gastos ${change > 0 ? 'aumentaram' : 'diminu√≠ram'} ${Math.abs(change)}% em rela√ß√£o ao m√™s anterior.`;
                }
            }

            document.getElementById('aiAnalysis').textContent = analysis;

            // Dicas de economia melhoradas
            const tips = [];
            
            if (nonEssentialPercent > 30) {
                tips.push('üí° Considere reduzir gastos n√£o essenciais em 15% para aumentar sua economia mensal');
            }
            
            if (essentialPercent > 60) {
                tips.push('üè† Avalie se todos os gastos essenciais s√£o realmente necess√°rios este m√™s');
            }
            
            if (total < revenueTotal * 0.7) {
                tips.push('‚úÖ Excelente! Voc√™ est√° economizando mais de 30% da sua renda');
            }
            
            if (savings < 0) {
                tips.push('üö® Aten√ß√£o: Voc√™ est√° gastando mais do que ganha. Considere revisar seus gastos essenciais');
            }

            const tipsList = document.getElementById('savingsTips');
            tipsList.innerHTML = tips.length > 0 
                ? tips.map(tip => `<li>${tip}</li>`).join('')
                : '<li>Seus gastos est√£o dentro de uma propor√ß√£o saud√°vel. Continue assim!</li>';
        }

        // Sistema de Notifica√ß√µes
        function showNotification(message, type = 'info') {
            let notificationContainer = document.querySelector('.notification-container');
            if (!notificationContainer) {
                notificationContainer = document.createElement('div');
                notificationContainer.className = 'notification-container';
                document.body.appendChild(notificationContainer);
            }
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas fa-${getNotificationIcon(type)}"></i>
                </div>
                <div class="notification-content">${message}</div>
                <button class="notification-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            notificationContainer.appendChild(notification);
            
            // Auto-remover ap√≥s 5 segundos
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        function getNotificationIcon(type) {
            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                warning: 'exclamation-triangle',
                info: 'info-circle'
            };
            return icons[type] || 'info-circle';
        }

        // Fechar modais ao clicar fora
        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEditModal();
            }
        });

        document.getElementById('addGoalModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAddGoalModal();
            }
        });

        // Inicializar app quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>